<app-header></app-header>

<div class="container mt-4">
  <div class="row">
    <div class="col-md-8 offset-md-2">
      <div class="card">
        <div class="card-body">
          <h2 class="card-title">Translation Training</h2>
          
          <!-- Translation Form -->
          <div class="mb-3">
            <label for="sourceText" class="form-label">Enter text to translate:</label>
            <textarea 
              id="sourceText" 
              class="form-control" 
              [(ngModel)]="sourceText" 
              rows="3">
            </textarea>
          </div>

          <div class="mb-3">
            <label class="form-label">Source Language:</label>
            <div class="btn-group" role="group">
              <input type="radio" class="btn-check" name="sourceLanguage" id="fijian" 
                     [(ngModel)]="sourceLanguage" value="fj" autocomplete="off">
              <label class="btn btn-outline-primary" for="fijian">Fijian</label>

              <input type="radio" class="btn-check" name="sourceLanguage" id="english" 
                     [(ngModel)]="sourceLanguage" value="en" autocomplete="off">
              <label class="btn btn-outline-primary" for="english">English</label>
            </div>
          </div>

          <button 
            class="btn btn-primary" 
            (click)="translateUsingClaude()" 
            [disabled]="isTranslating">
            {{ isTranslating ? 'Translating...' : 'Translate' }}
          </button>
        </div>
      </div>

      <!-- Error Message -->
      <div *ngIf="error" class="alert alert-danger mt-3">
        {{ error }}
      </div>

      <!-- Translation Result -->
      <div *ngIf="currentTranslation" class="card mt-3">
        <div class="card-body">
          <h5 class="card-title">Translation Result</h5>
          <p class="card-text">{{ currentTranslation.translatedText }}</p>
          
          <!-- Show number of similar translations if any -->
          <div *ngIf="currentTranslation.similarTranslations > 0" class="alert alert-info">
            Found {{ currentTranslation.similarTranslations }} similar translation(s) in the database.
          </div>

          <!-- Verification Form -->
          <div class="mt-3">
            <label for="verifiedTranslation" class="form-label">Verified Translation:</label>
            <textarea 
              id="verifiedTranslation" 
              class="form-control" 
              [(ngModel)]="verifiedTranslation" 
              rows="3">
            </textarea>
            
            <button 
              class="btn btn-success mt-2" 
              (click)="verifyTranslation()" 
              [disabled]="isVerifying">
              {{ isVerifying ? 'Verifying...' : 'Submit Verification' }}
            </button>
          </div>

          <!-- Verification Success Message -->
          <div *ngIf="verificationSuccess" class="alert alert-success mt-3">
            {{ verificationSuccess }}
          </div>

          <!-- Raw Response Toggle -->
          <button 
            class="btn btn-link mt-2" 
            (click)="toggleRawResponse()">
            {{ showRawResponse ? 'Hide' : 'Show' }} Raw Response
          </button>
          
          <div *ngIf="showRawResponse" class="mt-2">
            <pre>{{ currentTranslation.rawResponse }}</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
