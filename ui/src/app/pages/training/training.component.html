<app-header></app-header>
<div class="container mx-auto px-4 py-8">
  <!-- Error Message Display -->
  <div *ngIf="errorMessage" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
    <span class="block sm:inline">{{ errorMessage }}</span>
  </div>

  <!-- Translation Section -->
  <div class="bg-white rounded-lg shadow-md p-6 mb-6">
    <h2 class="text-2xl font-semibold text-primary mb-4">Enter Fijian Text to Translate</h2>
    <div class="space-y-4">
      <div>
        <textarea
          [(ngModel)]="fijianText"
          rows="4"
          class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent"
          placeholder="Enter Fijian text here..."
        ></textarea>
      </div>
      <button
      (click)="translateUsingClaude()"  <!-- Changed from translateText() -->
      [disabled]="isTranslating"
      class="bg-primary text-white px-6 py-2 rounded-md hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed"
    >
      <span *ngIf="!isTranslating">Translate using Claude</span>
      <span *ngIf="isTranslating">Translating...</span>
    </button>
    </div>
  </div>

  <!-- Verification Section -->
<!-- Find the verification section and replace/update it with this -->
<div *ngIf="currentTranslation" class="mt-4">
  <h4 class="mb-3">Machine Translation:</h4>
  <div class="alert" [ngClass]="{
    'alert-success': currentTranslation.confidence === 'high',
    'alert-warning': currentTranslation.confidence === 'medium',
    'alert-info': currentTranslation.confidence === 'low'
  }">
    <p class="mb-2"><strong>Translation:</strong> {{ currentTranslation.translation }}</p>
    <p class="mb-2"><strong>Confidence:</strong> {{ currentTranslation.confidence }}</p>
    <p class="mb-0" *ngIf="currentTranslation.notes">
      <strong>Notes:</strong> {{ currentTranslation.notes }}
    </p>
  </div>

  <!-- New Verification Section -->
  <div class="mt-4">
    <h4 class="mb-3">Verify Translation</h4>
    
    <!-- Original Fijian Text Display -->
    <div class="mb-3">
      <label class="form-label text-muted">Original Fijian Text:</label>
      <div class="p-3 bg-light border rounded">
        {{ fijianText }}
      </div>
    </div>

    <!-- Editable English Translation -->
    <div class="mb-4">
      <label for="verifiedTranslation" class="form-label">Edit Translation if needed</label>
      <textarea 
        class="form-control"
        id="verifiedTranslation"
        rows="4"
        [(ngModel)]="verifiedTranslation"
        placeholder="Edit the translation here..."
      ></textarea>
    </div>

    <div class="d-grid gap-2">
      <button 
        class="btn btn-success btn-lg"
        (click)="verifyTranslation()"
        [disabled]="isVerifying || !verifiedTranslation">
        <span *ngIf="isVerifying" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
        {{ isVerifying ? 'Verifying...' : 'Verify Translation' }}
      </button>
    </div>
  </div>
</div>
